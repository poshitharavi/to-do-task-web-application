# TODO List Backend Using Nest JS

## Setup Instructions

Follow these steps to get the backend project running on your local machine:

### Prerequisites:

- Make sure you have [Node.js](https://nodejs.org/) (version 18 or higher recommended) and [npm](https://www.npmjs.com/) (or [yarn](https://yarnpkg.com/)) installed on your system.
- Ensure you have [PostgreSQL](https://www.postgresql.org/) installed and running.

### Clone the Repository:

```bash
git clone <your_repository_url>
cd <your_project_directory>
(Replace <your_repository_url> with the actual URL of your project repository and <your_project_directory> with the name of the cloned directory.)
```

Install Dependencies:

Bash

```
npm install
or

Bash

yarn install
```

This command will install all the necessary packages, including NestJS, Prisma, and other dependencies defined in the package.json file.

Set up Environment Variables:
Create a .env file in the root of your project directory. Copy the following content into the .env file and replace the placeholder with your actual PostgreSQL connection string and desired port:

Code snippet

```
DATABASE_URL="postgresql://<db_user>:<db_password>@<db_host>:<db_port>/<db_name>?schema=public"
PORT=3010
JWT_SECRET="your_secret_key" # Add a strong secret key for JWT
(Remember to replace <db_user>, <db_password>, <db_host>, <db_port>, and <db_name> with your PostgreSQL database credentials. Also, set a strong and unique value for JWT_SECRET.)
```

Run Database Migrations:
Prisma ORM uses migrations to manage your database schema. Run the following command to create and apply the initial migrations:

Bash

```
npx prisma migrate dev --name init
This will create the necessary tables in your PostgreSQL database based on your Prisma schema definition (schema.prisma file).
```

Run the Backend Application:
Bash

```
npm run start:dev
or

Bash

yarn start:dev
This command will start the NestJS development server. You should see output indicating that the server is running, typically on http://localhost:3010 (or the port you specified in your .env file).

```

Project Structure
Here's a general overview of the typical structure of your NestJS project:

```
├── src/
│ ├── app.controller.ts # Main application controller
│ ├── app.module.ts # Main application module
│ ├── app.service.ts # Main application service
│ ├── auth/ # Authentication related files
│ │ ├── auth.controller.ts
│ │ ├── auth.guard.ts
│ │ ├── auth.module.ts
│ │ ├── auth.service.ts
│ │ ├── dto/ # Data Transfer Objects for authentication
│ │ │ ├── login.dto.ts
│ │ │ └── register.dto.ts
│ │ └── strategies/ # Passport strategies (e.g., JWT)
│ │ └── jwt.strategy.ts
│ ├── task/ # Task related files
│ │ ├── dto/ # Data Transfer Objects for task operations
│ │ │ ├── create-task.dto.ts
│ │ │ ├── update-task.dto.ts
│ │ │ └── task-query.dto.ts
│ │ ├── task.controller.ts
│ │ ├── task.module.ts
│ │ ├── task.service.ts
│ │ └── entities/ # Prisma generated entities (optional to directly import)
│ ├── user/ # User related files
│ │ ├── dto/ # Data Transfer Objects for user operations
│ │ │ └── create-user.dto.ts
│ │ ├── user.controller.ts
│ │ ├── user.module.ts
│ │ ├── user.service.ts
│ │ └── entities/ # Prisma generated entities (optional to directly import)
│ ├── main.ts # Application entry point
│ └── prisma/ # Prisma related files
│ ├── migrations/ # Database migration files
│ └── schema.prisma # Prisma schema definition
├── test/ # Unit and E2E tests
├── .env # Environment variables
├── .eslintrc.js # ESLint configuration
├── .gitignore # Specifies intentionally untracked files that Git should ignore
├── nest-cli.json # Nest CLI configuration
├── package-lock.json # Records the exact versions of dependencies
├── package.json # Project dependencies and scripts
├── README.md # Project documentation
├── tsconfig.build.json # TypeScript build configuration
└── tsconfig.json # TypeScript configuration

```

**Key Directories:**

- `src`: Contains the main application source code, organized into modules, controllers, services, and DTOs.
- `auth`: Handles user authentication and authorization logic, including login, registration, and JWT-based authentication.
- `task`: Manages task-related operations, such as creating, updating, deleting, and retrieving tasks.
- `user`: Contains logic for user management, such as creating and retrieving user information.
- `prisma`: Holds the Prisma schema definition and generated database client.
- `dto`: Data Transfer Objects define the structure of data being sent to and from the API.
- `entities`: (Generally auto-generated by Prisma) Define the structure of your database models.

## API Documentation

Here are the details of your API endpoints:

**Base URL:** `{{base_url}}` (e.g., `http://localhost:3010/`)

### General

#### Hello World

GET {{base_url}}

**Response:**

```json
"Hello World!"
Users
User Login
POST {{base_url}}user/login
Request Body:

JSON

{
    "userName": "sample",
    "password": "password"
}
Response (Success - HTTP 200 OK):

JSON

{
    "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOjEsInVzZXJOYW1lIjoic2FtcGxlIiwiaWF0IjoxNzEwOTYxMjAwLCJleHAiOjE3MTEwNDc2MDB9.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
}
(The access_token is a JWT bearer token that needs to be included in the Authorization header for protected routes.)

Response (Failure - HTTP 401 Unauthorized):

JSON

{
    "statusCode": 401,
    "message": "Unauthorized"
}
User Registration
POST {{base_url}}user/register
Request Body:

JSON

{
    "userName": "sample",
    "password": "password",
    "name": "Sample"
}
Response (Success - HTTP 201 Created):

JSON

{
    "id": 1,
    "userName": "sample",
    "name": "Sample"
    // ... other user details
}
Response (Failure - HTTP 400 Bad Request):

JSON

{
    "statusCode": 400,
    "message": [
        "userName must be shorter than or equal to 50 characters",
        "userName must be a string",
        "password must be longer than or equal to 6 characters",
        "password must be a string",
        "name must be a string"
        // ... other validation errors
    ],
    "error": "Bad Request"
}
Task
Authentication: All Task-related endpoints (except where explicitly noted) require a valid JWT bearer token in the Authorization header. The format should be Authorization: Bearer <access_token>.

Create New Task
POST {{base_url}}task/new
Request Body:

JSON

{
    "dueDate": "2025-10-04T00:00:00Z",
    "title": "Sample Title",
    "priority": "LOW",
    "recurrence": "NONE",
    "isDependent": true,
    "prerequisite": 1
}
Request Headers:

Authorization: Bearer <access_token>
Content-Type: application/json
Response (Success - HTTP 201 Created):

JSON

{
    "id": 7,
    "dueDate": "2025-10-04T00:00:00.000Z",
    "title": "Sample Title",
    "priority": "LOW",
    "recurrence": "NONE",
    "isDependent": true,
    "prerequisite": 1,
    "userId": 1
    // ... other task details
}
Response (Failure - HTTP 400 Bad Request):

JSON

{
    "statusCode": 400,
    "message": [
        "dueDate must be a valid ISO 8601 date string",
        "title must be a string",
        "title must not be empty",
        "priority must be one of the following values: LOW, MEDIUM, HIGH",
        "recurrence must be one of the following values: NONE, DAILY, WEEKLY, MONTHLY",
        "prerequisite must be an integer",
        "prerequisite must be greater than or equal to 1"
        // ... other validation errors
    ],
    "error": "Bad Request"
}
Update Task
PATCH {{base_url}}task/update/6
Request Body:

JSON

{
    "dueDate": "2025-10-05T00:00:00Z",
    "title": "Updated Sample Title",
    "priority": "HIGH",
    "recurrence": "NONE",
    "isDependent": true,
    "prerequisite": 2
}
Request Headers:

Authorization: Bearer <access_token>
Content-Type: application/json
Response (Success - HTTP 200 OK):

JSON

{
    "affected": 1
}
Response (Failure - HTTP 404 Not Found):

JSON

{
    "statusCode": 404,
    "message": "Task with ID 6 not found",
    "error": "Not Found"
}
Response (Failure - HTTP 400 Bad Request): (Similar validation errors as in the "Create New Task" endpoint)

Delete Task
DELETE {{base_url}}task/delete/6
Request Headers:

Authorization: Bearer <access_token>
Response (Success - HTTP 200 OK):

JSON

{
    "affected": 1
}
Response (Failure - HTTP 404 Not Found):

JSON

{
    "statusCode": 404,
    "message": "Task with ID 6 not found",
    "error": "Not Found"
}
Get My Tasks (with Filtering and Sorting)
GET {{base_url}}task/my?sortBy=id&sortOrder=asc&title=sample
Request Headers:

Authorization: Bearer <access_token>
Query Parameters:

sortBy (optional): Field to sort by (e.g., id, dueDate, title, priority). Default might be createdAt.
sortOrder (optional): Sorting order (asc for ascending, desc for descending). Default might be asc.
title (optional): Filter tasks by title (performs a partial match).
You might have other query parameters for filtering (e.g., by priority, dueDate range).
Response (Success - HTTP 200 OK):

JSON

[
    {
        "id": 1,
        "dueDate": "2025-10-01T00:00:00.000Z",
        "title": "Sample Task 1",
        "priority": "LOW",
        "recurrence": "NONE",
        "isDependent": false,
        "prerequisite": null,
        "userId": 1
    },
    {
        "id": 3,
        "dueDate": "2025-10-03T00:00:00.000Z",
        "title": "Another Sample Task",
        "priority": "MEDIUM",
        "recurrence": "WEEKLY",
        "isDependent": true,
        "prerequisite": 1,
        "userId": 1
    }
    // ... more tasks
]
Update Task Status
PATCH {{base_url}}task/update-status/5
Request Headers:

Authorization: Bearer <access_token>
Request Body: (Assuming you'll send the new status in the request body, e.g.,)

JSON

{
    "status": "COMPLETED"
}
(You might have different status values like "TODO", "IN_PROGRESS", "BLOCKED", etc.)

Response (Success - HTTP 200 OK):

JSON

{
    "id": 5,
    "dueDate": "2025-10-05T00:00:00.000Z",
    "title": "A Task to Complete",
    "priority": "HIGH",
    "recurrence": "NONE",
    "isDependent": false,
    "prerequisite": null,
    "userId": 1,
    "status": "COMPLETED"
    // ... other task details
}
Response (Failure - HTTP 404 Not Found):

JSON

{
    "statusCode": 404,
    "message": "Task with ID 5 not found",
    "error": "Not Found"
}
Response (Failure - HTTP 400 Bad Request): (If the provided status is invalid)

JSON

{
    "statusCode": 400,
    "message": [
        "status must be one of the following values: TODO, IN_PROGRESS, COMPLETED, BLOCKED"
    ],
    "error": "Bad Request"
}
```
